<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcluon: cluon::OD4Session Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libcluon
   &#160;<span id="projectnumber">0.0.139</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classcluon_1_1OD4Session.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classcluon_1_1OD4Session-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">cluon::OD4Session Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="OD4Session_8hpp_source.html">OD4Session.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad9d26426cf2714e105c27a23ce4a0f7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1OD4Session.html#ad9d26426cf2714e105c27a23ce4a0f7a">OD4Session</a> (uint16_t CID, std::function&lt; void(cluon::data::Envelope &amp;&amp;envelope)&gt; delegate=nullptr) noexcept</td></tr>
<tr class="separator:ad9d26426cf2714e105c27a23ce4a0f7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d9843ae35fa1a0fbe130877aa959025"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1OD4Session.html#a8d9843ae35fa1a0fbe130877aa959025">send</a> (cluon::data::Envelope &amp;&amp;envelope) noexcept</td></tr>
<tr class="separator:a8d9843ae35fa1a0fbe130877aa959025"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d79b313afe89bc3a8622d1801c0037c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1OD4Session.html#a5d79b313afe89bc3a8622d1801c0037c">dataTrigger</a> (int32_t messageIdentifier, std::function&lt; void(cluon::data::Envelope &amp;&amp;envelope)&gt; delegate) noexcept</td></tr>
<tr class="separator:a5d79b313afe89bc3a8622d1801c0037c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bd324b893072614ba917e5f1fd1cdc2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1OD4Session.html#a2bd324b893072614ba917e5f1fd1cdc2">timeTrigger</a> (float freq, std::function&lt; bool()&gt; delegate) noexcept</td></tr>
<tr class="separator:a2bd324b893072614ba917e5f1fd1cdc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01745bfed160ac4fd16c71828672e7e8"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a01745bfed160ac4fd16c71828672e7e8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classcluon_1_1OD4Session.html#a01745bfed160ac4fd16c71828672e7e8">send</a> (T &amp;message, const cluon::data::TimeStamp &amp;sampleTimeStamp=cluon::data::TimeStamp(), uint32_t senderStamp=0) noexcept</td></tr>
<tr class="separator:a01745bfed160ac4fd16c71828672e7e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1381dc975919e3ef0592e9bfa032c8df"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1OD4Session.html#a1381dc975919e3ef0592e9bfa032c8df">isRunning</a> () noexcept</td></tr>
<tr class="separator:a1381dc975919e3ef0592e9bfa032c8df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class provides an interface to an OpenDaVINCI v4 session. An OpenDaVINCI v4 session allows the automatic exchange of time-stamped Envelopes carrying user-defined messages usually using UDP multicast. A running <a class="el" href="classcluon_1_1OD4Session.html">OD4Session</a> will not receive the bytes that itself has sent to other microservices.</p>
<p>There are two ways to participate in an OpenDaVINCI session. Variant A is simply calling a user-supplied lambda whenever a new Envelope is received:</p>
<div class="fragment"><div class="line"><a class="code" href="classcluon_1_1OD4Session.html">cluon::OD4Session</a> od4{111, [](cluon::data::Envelope &amp;&amp;envelope){ std::cout &lt;&lt; <span class="stringliteral">&quot;Received cluon::Envelope&quot;</span> &lt;&lt; std::endl;}</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// Do something in parallel.</span></div><div class="line"></div><div class="line">MyMessage msg;</div><div class="line">od4.<a class="code" href="classcluon_1_1OD4Session.html#a8d9843ae35fa1a0fbe130877aa959025">send</a>(msg);</div></div><!-- fragment --><p>Variant B allows a more fine-grained setup where you specify the Envelopes of interest:</p>
<div class="fragment"><div class="line"><a class="code" href="classcluon_1_1OD4Session.html">cluon::OD4Session</a> od4{111};</div><div class="line"></div><div class="line">od4.<a class="code" href="classcluon_1_1OD4Session.html#a5d79b313afe89bc3a8622d1801c0037c">dataTrigger</a>(cluon::data::TimeStamp::ID(), [](cluon::data::Envelope &amp;&amp;envelope){ std::cout &lt;&lt; <span class="stringliteral">&quot;Received cluon::data::TimeStamp&quot;</span> &lt;&lt; std::endl;});</div><div class="line">od4.dataTrigger(MyMessage::ID(), [](cluon::data::Envelope &amp;&amp;envelope){ std::cout &lt;&lt; <span class="stringliteral">&quot;Received MyMessage&quot;</span> &lt;&lt; std::endl;});</div><div class="line"></div><div class="line"><span class="comment">// Do something in parallel.</span></div><div class="line"></div><div class="line">MyMessage msg;</div><div class="line">od4.send(msg);</div></div><!-- fragment --><p>Next to receive Envelopes, <a class="el" href="classcluon_1_1OD4Session.html">OD4Session</a> can call a user-supplied lambda in a time-triggered way. The lambda is executed as long as it does not return false or throws an exception that is then caught in the method timeTrigger and the method is exited:</p>
<div class="fragment"><div class="line"><a class="code" href="classcluon_1_1OD4Session.html">cluon::OD4Session</a> od4{111};</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keywordtype">float</span> FREQ{10}; <span class="comment">// 10 Hz.</span></div><div class="line">od4.<a class="code" href="classcluon_1_1OD4Session.html#a2bd324b893072614ba917e5f1fd1cdc2">timeTrigger</a>(FREQ, [](){</div><div class="line">  <span class="comment">// Do something time-triggered.</span></div><div class="line">  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">}); <span class="comment">// This call blocks until the lambda returns false.</span></div></div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad9d26426cf2714e105c27a23ce4a0f7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d26426cf2714e105c27a23ce4a0f7a">&#9670;&nbsp;</a></span>OD4Session()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cluon::OD4Session::OD4Session </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>CID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; void(cluon::data::Envelope &amp;&amp;envelope)&gt;&#160;</td>
          <td class="paramname"><em>delegate</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CID</td><td>OpenDaVINCI v4 session identifier [1 .. 254] </td></tr>
    <tr><td class="paramname">delegate</td><td>Function to call on newly arriving Envelopes ("catch-all"); if a nullptr is passed, the method dataTrigger can be used to set message specific delegates. Please note that it is NOT possible to have both: a delegate for "catch-all" and the data-triggered ones. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a5d79b313afe89bc3a8622d1801c0037c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d79b313afe89bc3a8622d1801c0037c">&#9670;&nbsp;</a></span>dataTrigger()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool cluon::OD4Session::dataTrigger </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>messageIdentifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; void(cluon::data::Envelope &amp;&amp;envelope)&gt;&#160;</td>
          <td class="paramname"><em>delegate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method sets a delegate to be called data-triggered on arrival of a new Envelope for a given message identifier.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">messageIdentifier</td><td>Message identifier to assign a delegate. </td></tr>
    <tr><td class="paramname">delegate</td><td>Function to call on newly arriving Envelopes; setting it to nullptr will erase it. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the given delegate could be successfully set or unset. </dd></dl>

<p class="reference">References <a class="el" href="namespacecluon_1_1time.html#ae2df73301f037b992abdb8b66c5e35b3">cluon::time::convert()</a>, <a class="el" href="namespacecluon.html#aed0cd92bb770ffdcba8c63de7ad1e6ac">cluon::extractEnvelope()</a>, and <a class="el" href="MessageParser_8cpp.html#ad4b02d239c8387bc0498b8a690ef5a16">retVal</a>.</p>

</div>
</div>
<a id="a1381dc975919e3ef0592e9bfa032c8df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1381dc975919e3ef0592e9bfa032c8df">&#9670;&nbsp;</a></span>isRunning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool cluon::OD4Session::isRunning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8d9843ae35fa1a0fbe130877aa959025"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d9843ae35fa1a0fbe130877aa959025">&#9670;&nbsp;</a></span>send() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cluon::OD4Session::send </td>
          <td>(</td>
          <td class="paramtype">cluon::data::Envelope &amp;&amp;&#160;</td>
          <td class="paramname"><em>envelope</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method will send a given Envelope to this OpenDaVINCI v4 session.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">envelope</td><td>to be sent. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="namespacecluon.html#a8ff42dcd356aa1d0ef8e41a8aa2bead2">cluon::serializeEnvelope()</a>.</p>

</div>
</div>
<a id="a01745bfed160ac4fd16c71828672e7e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01745bfed160ac4fd16c71828672e7e8">&#9670;&nbsp;</a></span>send() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cluon::OD4Session::send </td>
          <td>(</td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cluon::data::TimeStamp &amp;&#160;</td>
          <td class="paramname"><em>sampleTimeStamp</em> = <code>cluon::data::TimeStamp()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>senderStamp</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method will send a given message to this OpenDaVINCI v4 session.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>Message to be sent. </td></tr>
    <tr><td class="paramname">sampleTimeStamp</td><td>Time point when this sample to be sent was captured (default = sent time point). </td></tr>
    <tr><td class="paramname">senderStamp</td><td>Optional sender stamp (default = 0). </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="classcluon_1_1ToProtoVisitor.html#a20841380c5c8e865f30f92d164477e81">cluon::ToProtoVisitor::encodedData()</a>, and <a class="el" href="namespacecluon_1_1time.html#a4265a23bd4bd2b5ed37abff8dffddd25">cluon::time::now()</a>.</p>

</div>
</div>
<a id="a2bd324b893072614ba917e5f1fd1cdc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bd324b893072614ba917e5f1fd1cdc2">&#9670;&nbsp;</a></span>timeTrigger()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cluon::OD4Session::timeTrigger </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; bool()&gt;&#160;</td>
          <td class="paramname"><em>delegate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method sets a delegate to be called time-triggered using the specified frequency until the delegate returns false. This method blocks until the delegate has returned false or threw an exception. Thus, this method is typically called as last statement in a main function of a program.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freq</td><td>Frequency in Hertz to run the given delegate. </td></tr>
    <tr><td class="paramname">delegate</td><td>Function to call according to the given frequency. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="classcluon_1_1TerminateHandler.html#ad60098801d72e40cb55505f383b61948">cluon::TerminateHandler::instance()</a>, <a class="el" href="namespacecluon_1_1time.html#a4265a23bd4bd2b5ed37abff8dffddd25">cluon::time::now()</a>, and <a class="el" href="namespacecluon_1_1time.html#ad7e0afa86b32cbb3e78b392664d0793a">cluon::time::toMicroseconds()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecluon.html">cluon</a></li><li class="navelem"><a class="el" href="classcluon_1_1OD4Session.html">OD4Session</a></li>
    <li class="footer">Generated on Mon Feb 1 2021 17:45:25 for libcluon by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
